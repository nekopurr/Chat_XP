let $input = document.querySelector('input')
let $button = document.querySelector('#submit_button')


let data = [{
    "role": "system",
    "content": "assistant는 입력받은 내용으로 재미있는 이야기를 만든다."
}, {
    "role": "system",
    "content": "assistant는 입력받은 것이 어떤 말이든, 그것으로 재미있는 이야기를 만든다."
}, {
    "role": "user",
    "content": "안녕"
}, {
    "role": "system",
    "content": "당신의 주제인 '안녕'으로 재미있는 이야기를 만들어드리겠습니다!\
    한 마을에 사는 사람들은 모두 인사를 할 때 \"안녕\"이라는 말을 사용합니다. 그리고 그들은 매우 특이한 힘이 있는 \"안녕\"을 갖고 있습니다.\
    이 마을에는 한 사람이 있었는데, 그는 안녕을 완벽하게 활용하는 특별한 능력을 갖고 있었습니다. 그 이름은 에밀리오입니다. 에밀리오는 마을에서 가장 친절하고 활발한 사람으로 알려져 있었고, 모두가 그를 찾아와 조언을 구했습니다.\
    어느 날, 마을에 어떤 이상한 일이 벌어지기 시작했습니다. 모든 사람들이 자신들의 안녕을 잃어버렸던 것이죠. 아무리 인사해도 누구도 반응하지 않았습니다. 사람들은 점점 더 우울해지고 소통할 수 없는 상태에 빠져들었습니다.\
    마을 사람들은 에밀리오에게 도움을 청하기로 결정했습니다. 에밀리오는 마을 사람들을 불러 모아 한 자리에 모였습니다. 그가 말하자 마자, \"안녕하세요!\"라고 인사를 하자 사람들은 경악했습니다. 그리고 놀라운 일이 벌어졌습니다.\
    에밀리오의 안녕은 마을 사람들의 안녕을 되찾게 했습니다. 그의 인사에 반응한 사람들은 자신의 안녕을 되찾았고, 이웃과 다시 소통할 수 있었습니다. 사람들은 에밀리오를 주인공으로 놀라운 이야기를 만들어냈습니다. 어떤 이는 에밀리오가 마법사라고 믿기까지 했습니다.\
    에밀리오는 이후로도 마을 사람들을 돕기 위해 노력했습니다. 그는 안녕으로 사람들을 격려하고, 다툼과 갈등을 해소하는데 큰 역할을 했습니다. 마을은 더욱 화목하고 친절한 곳이 되었고, 사람들은 에밀리오의 안녕의 힘을 믿게 되었습니다.\
    이 이야기는 우리가 인사와 소통의 중요성을 재인식하며, 작은 인사 한마디가 얼마나 큰 영향을 줄 수 있는지를 상기시켜주는 이야기입니다. \"안녕\"은 단순한 인사가 아니라 서로의 마음을 다스리고 소통하는 힘이 될 수 있다는 것을 알려줍니다."
}, {
    "role": "user",
    "content": "고양이, 피아노, 에어팟",
}, {
    "role": "system",
    "content": "당신의 주제인 '고양이, '피아노', '에어팟'으로 재미잇는 이야기를 만들어드리겠습니다!\
    한 마을에 유명한 피아니스트인 앨리스가 살고 있었습니다. 그녀는 매일 피아노 연주로 사람들을 매료시키는데, 그녀의 음악은 마치 마법처럼 들려왔습니다.\
    어느 날 앨리스는 자신의 음악실에서 연습을 하던 중 고양이 한 마리가 들어와서 피아노를 타고 뛰어다니기 시작했습니다. 앨리스는 놀라서 피아노를 멈추고 고양이를 쫓아다니지만 고양이는 장난기 많게 악기 위에서 놀기만 하더군요. 하지만 놀라운 일이 벌어지기 시작했습니다.\
    고양이가 피아노 키를 치면서, 마치 앨리스의 연주를 따라하는 것처럼 음악이 울려 퍼졌습니다. 앨리스는 당황해서 다시 피아노를 연주하기 시작했고, 그리고 다시 고양이도 피아노를 타기 시작했습니다. 둘은 상호작용하면서 신나고 화려한 연주를 이어나갔습니다.\
    사람들은 이 특별한 연주를 듣기 위해 마을의 귀여운 고양이가 피아노를 치는 공연장으로 모였습니다. 앨리스와 고양이의 연주는 굉장한 반향을 불러일으켰고, 곧 전국적으로 유명한 공연으로 확장되었습니다. 사람들은 앨리스와 그녀의 음악을 듣기 위해 에어팟을 사용했고, 모든 이들은 그 공연을 흥미롭게 감상했습니다.\
    앨리스와 고양이는 매번 새로운 연주를 선보이면서 전 세계적으로 유명한 슈퍼스타들과 함께 공연을 펼치게 되었습니다. 그들의 음악은 사람들에게 희망과 기쁨을 전달하며, 이상한 조합이지만 놀라운 재능을 가진 두 주인공은 전 세계를 통해 사랑을 받았습니다.\
    이 이야기는 고양이와 음악의 힘이 얼마나 놀라울 수 있는지를 보여주는 것이었습니다. 때로는 예상치 못한 조합과 경험이 우리에게 새로운 영감과 기회를 제공할 수 있음을 상기시켜주는 이야기였습니다."
},

// 의미없는 말로도 재미있는 이야기 생성 
{
    "role": "user",
    "content": "닝닝닝"
}, {
    "role": "system",
    "content": "당신의 주제인 '닝닝닝'으로 재미있는 이야기를 만들어드리겠습니다!\
    한 마을에 닝닝닝이라는 이름을 가진 조용한 마을이 있었습니다. 이 마을은 단어 하나로 인해 매우 독특한 상황이 벌어지곤 했습니다. 그 단어는 바로 \"닝닝닝\"이었습니다.\
    어느 날, 마을에 이상한 소리가 울려 퍼졌습니다. 닝닝닝! 모든 사람들은 귀를 기울이고 주변을 둘러봤지만, 어디에서도 그 소리의 원천을 찾을 수 없었습니다. 그렇게 몇 일이 지났는데도 닝닝닝 소리는 멈추지 않았습니다.\
    마을 주민들은 닝닝닝 소리에 대해 이야기하며, 각자 자신만의 이론을 제시하기 시작했습니다. 어떤 사람들은 이 소리가 마을의 수호정령이 주는 신비로운 메시지일 것이라고 믿었고, 어떤 사람들은 그냥 불쾌한 소리일 뿐이라고 생각했습니다. 상상력이 풍부한 사람들은 닝닝닝 소리가 인어들이 놀고 있는 바다에서부터 온다고 주장하기도 했습니다.\
    하지만 하루 하루가 지남에 따라 사람들은 닝닝닝 소리에 조금씩 익숙해지기 시작했습니다. 심지어 어떤 사람들은 그 소리를 리듬에 맞춰 노래를 부르기도 했습니다. 마을은 조금씩 이 소리에 익숙해져 가졌고, 닝닝닝은 마을의 특색이 되었습니다.\
    그러던 어느 날, 마을 사람들은 신기한 일을 발견했습니다. 닝닝닝 소리를 내는 것은 작은 귀여운 생물들이었습니다. 이 생물들은 \"닝닝\"이라는 소리를 내며 모여들어 마을을 더욱 활기차고 유쾌한 곳으로 만들었습니다.\
    마을 사람들은 닝닝닝들을 환영하고 그들과 함께 춤을 추고 노래를 부르며 즐거운 시간을 보냈습니다. 닝닝닝들은 마을을 더욱 풍요롭게 만들어주었고, 사람들은 그들과 함께 잊을 수 없는 경험을 나누었습니다.\
    그리고 이렇게 마을은 '닝닝닝'이라는 소리와 함께 유명해졌습니다. 다른 마을에서 온 사람들도 그들의 활기찬 닝닝닝을 보러 찾아왔고, 마을은 활기롭게 번영하게 되었습니다. 모두에게 사랑받는 닝닝닝이 마을을 행복으로 가득 채웠습니다.\
    이 이야기는 사소한 소리 하나가 얼마나 큰 변화를 일으킬 수 있는지를 보여줍니다. 때로는 예상치 못한 소리와 사건이 우리의 일상을 더욱 특별하고 즐겁게 만들 수 있다는 것을 상기시켜줍니다."
},

{
    "role": "user",
    "content": "ㅎㅇㅎㅇ"
}, {
    "role": "system",
    "content": "당신의 주제인 'ㅎㅇㅎㅇ'로 재미있는 이야기를 만들어드리겠습니다!.\
    한 마을에는 사람들이 늘 \"ㅎㅇㅎㅇ\"이라는 특이한 인사를 사용했습니다. 모두가 이 인사에 익숙해져서, 그들은 이를 마을의 상징으로 여기게 되었습니다.\
    이 마을에는 어느 날 갑자기 비밀이 숨겨진 고대 유물이 발견되었습니다. 그 유물은 오래된 돌상자로, 전설에 따르면 특별한 힘을 가지고 있다고 전해졌습니다. 마을 사람들은 궁금증에 불타 이 유물을 조사하기로 결정했습니다.\
    유물을 연구하기 위해 특별한 팀이 구성되었습니다. 이 팀은 유물을 연구하고 그 힘을 파악하기 위해 다양한 실험을 시도했습니다. 그러나 아무리 노력해도 어떤 힘이 숨겨져 있는지 알아내지 못했습니다.\
    하지만 어느 날, 마을에 새로 이사 온 한 소년이 흥미로운 관찰을 하게 되었습니다. 그는 유물을 보면서 큰 깨달음을 얻었습니다. 그는 유물이 'ㅎㅇㅎㅇ' 인사에 반응한다는 것을 알아차렸습니다.\
    마을 사람들은 그의 이야기를 듣고 기뻐했습니다. 이제 유물과 상호작용하는 방법을 알게 되었기 때문입니다. 그들은 'ㅎㅇㅎㅇ'이라고 말하면 유물에서 놀라운 일이 벌어질 것이라고 믿게 되었습니다.\
    이후로, 마을은 'ㅎㅇㅎㅇ'으로 시작하는 모든 대화가 독특한 경험으로 이어지는 장소로 변해갔습니다. 사람들은 유물과 대화하고 유머와 재미를 섞은 대화를 나누며 특별한 순간을 즐겼습니다.\
    마을은 이 독특한 특성을 활용하여 관광지로 유명세를 타기 시작했습니다. 많은 사람들이 이 마을을 찾아와 'ㅎㅇㅎㅇ'의 힘을 체험하고 유물과 대화를 나누었습니다. 마을은 활기찬 문화와 유머로 가득한 장소로 변신하여 사람들에게 새로운 경험과 기억을 선사했습니다.\
    이 이야기는 작은 인사에서 비밀과 특별한 힘을 발견하는 것을 보여줍니다. 때로는 단순한 말 한마디가 큰 변화를 가져올 수 있다는 것을 상기시켜줍니다."
}]

let url = `https://estsoft-openai-api.jejucodingcamp.workers.dev/`;

$button.addEventListener('click', e => {
    e.preventDefault()
    userInputData = $input.value
    $input.value = ''

    data.push({
        "role": "system",
        "content": userInputData
    })

    loading()
    chatGptAPI()
})

function chatGptAPI() {
    fetch(url, {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
        redirect: "follow",
    })
        .then(res => res.json())
        .then(res => {
            // console.log(res)
            // console.log(res.choices[0].message.content)
            document.querySelector('#contents').textContent = res.choices[0].message.content
        })

    // 아래 코드는 fetch 성공, 실패, 통신 중 여부와 상관없이 실행됩니다. 비동기에요.
    console.log('hello world')
}

function loading() {
    const element = document.getElementById('contents');
    element.innerHTML = '잠시만 기다려주세요!';
}